var ArduinoGeo=ArduinoGeo||function(){var e=function(e){var n=" "+document.cookie,t=n.indexOf(" "+e+"=");if(-1===t)n=null;else{t=n.indexOf("=",t)+1;var o=n.indexOf(";",t);-1===o&&(o=n.length),n=unescape(n.substring(t,o))}return n}("georestriction_selection");return{get:function(){return e}}}(),ArduinoAuthHelper=ArduinoAuthHelper||function(){var e,n=!1,t={init:function(){e=jQuery.Deferred()},authURL:"https://auth.arduino.cc/",getToken:function(){return e.then(function(e){return e?e.token:null})},setToken:function(t){n=!!t,e.resolve(t)},setLoggedOut:function(){t.setToken(null)},isLoggedIn:function(){return n}};return t}(),AlgoliaHelper=AlgoliaHelper||function(){var e=void 0;return{init:function(n){e=n},getAlgoliaSearch:function(){return e}}}(),ArduinoHeaderAndFooter=ArduinoHeaderAndFooter||function(){function e(e){return new Promise(function(n,t){var o=document.getElementsByTagName("head")[0],r=document.createElement("script");r.src=e,r.onload=r.onreadystatechange=n,r.onabort=r.onerror=t,o.appendChild(r)})}function n(e,n){var t,u,a,c,s,l=n.token;t=u=jQuery(".login-button");var f=jQuery(".logout");return e?(a=jQuery(".user-profile .userpic"),c=jQuery(".user-profile .default"),s=jQuery(".user-profile")):(u=jQuery(".login-button a"),a=jQuery(".profile img.user"),c=jQuery(".profile svg.default"),s=jQuery(".auth-required")),n.token().then(function(e){return ArduinoAuthHelper.setToken(e),i(e.token),function(e){return new Promise(function(n,t){jQuery.ajax({url:r+"v1/users/byID/me?scopes=public",success:function(e){n(e)},headers:{Authorization:"Bearer "+e},error:t})})}(e.token)}).then(function(e){t.hide();var o=e.public.avatar;return a.attr("src",o),c.hide(),a.show(),o||(c.show(),a.hide()),a.on("error",function(){c.show(),a.hide()}),s.show(),f.on("click",function(){if("function"==typeof n.logout)n.logout();else{var e=window.location.href;window.location.replace(r+"logout?redirect_uri="+e)}}),Promise.resolve(l)}).catch(function(){ArduinoAuthHelper.setLoggedOut();var e=n.redirectURI();return u.attr("href",e),t.show(),s.hide(),-1!==o.indexOf(window.location.hostname)&&jQuery(".main-nav").find(".cart-dropdown-trigger").show(),Promise.resolve(e)})}var t="https://cdn.arduino.cc/header-footer/s9fq2tkykw",o="https://store.arduino.cc";"usa"===ArduinoGeo.get()&&(o="https://store.arduino.cc/usa");var r=ArduinoAuthHelper.authURL,i=function(e){jQuery.ajax({url:"https://forum.arduino.cc/index.php?api&pm&json",headers:{Authorization:"Bearer "+e},success:function(e){e.data>0&&(jQuery(".profile .badge").html(e.data),jQuery(".profile .badge").show())},error:function(e){console.error(e)}})};return function(o){var i=["header","footer","newsletter-modal"];o.parts&&(i=o.parts);var u="en";o.lang&&(u=o.lang);var a,c=-1!==i.indexOf("create-nav");return new Promise(function(n,t){return"undefined"==typeof jQuery?n(e("https://code.jquery.com/jquery-2.1.1.min.js")):n()}).then(function(){o.algoliaSearch&&AlgoliaHelper.init(o.algoliaSearch)}).then(function(){ArduinoAuthHelper.init()}).then(function(){jQuery.get(t+"/create-nav-images/icons.svg",function(e){var n=document.createElement("div");n.className="icons",n.style.display="none",n.innerHTML=(new XMLSerializer).serializeToString(e.documentElement),document.body.insertBefore(n,document.body.childNodes[0])});for(var e=[],n=0;n<i.length;n++)e.push(function(e,n){return new Promise(function(o,r){var i=t+"/"+n+"/"+e+".html";jQuery.ajaxSetup({timeout:5e4}),jQuery("#"+e).load(i,function(e,n,t){return"success"!==n?r("failure to inject "+i):o("imported "+i)})})}(i[n],u));return Promise.all(e)}).then(function(){for(var e=[],n=0;n<i.length;n++)e.push(function(e){return new Promise(function(n,t){var o=document.getElementsByTagName("head")[0],r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onload=r.onreadystatechange=n,r.onabort=r.onerror=n,o.insertBefore(r,o.firstChild)})}(t+"/css/"+i[n]+".css"));return Promise.all(e)}).then(function(){for(var n=[],r=0;r<i.length;r++)n.push(e(t+"/js/"+i[r]+".js"));return"default"===o.auth&&n.push(e(t+"/login.js")),Promise.all(n)}).then(function(){return o.authOptions&&(o.authOptions.cookieName="arduino_authenticated"),"default"===o.auth?(o.authOptions.logoutURI||(o.authOptions.logoutURI=r+"logout"),o.authUri||(o.authUri=r+"login"),a=n(c,new Oauth2(o.authOptions))):"custom"===o.auth?a=n(c,o.authOptions):(-1!==r.indexOf(window.location.hostname)&&(a="loggedout",ArduinoAuthHelper.setLoggedOut(),jQuery(".login-button").show(),jQuery(".login-button").find("a").attr("href","/login")),Promise.resolve(a))}).then(function(){return o.langSelector&&jQuery(".language-selector").show(),c?jQuery("#ino-create-nav").show():jQuery(".main-nav").show(),Promise.resolve(a)})}}();!function(e){function n(){}function t(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],a(e,this)}function o(e,n){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(n):(e._handled=!0,void t._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(e){return void i(n.promise,e)}r(n.promise,o)}else(1===e._state?r:i)(n.promise,e._value)}))}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if(n instanceof t)return e._state=3,e._value=n,void u(e);if("function"==typeof o)return void a(function(e,n){return function(){e.apply(n,arguments)}}(o,n),e)}e._state=1,e._value=n,u(e)}catch(n){i(e,n)}}function i(e,n){e._state=2,e._value=n,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&t._immediateFn(function(){e._handled||t._unhandledRejectionFn(e._value)});for(var n=0,r=e._deferreds.length;n<r;n++)o(e,e._deferreds[n]);e._deferreds=null}function a(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,i(n,e))})}catch(e){if(t)return;t=!0,i(n,e)}}var c=setTimeout;t.prototype.catch=function(e){return this.then(null,e)},t.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new function(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}(e,t,r)),r},t.all=function(e){var n=Array.prototype.slice.call(e);return new t(function(e,t){function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,function(e){o(i,e)},t)}n[i]=u,0==--r&&e(n)}catch(e){t(e)}}if(0===n.length)return e([]);for(var r=n.length,i=0;i<n.length;i++)o(i,n[i])})},t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===t?e:new t(function(n){n(e)})},t.reject=function(e){return new t(function(n,t){t(e)})},t.race=function(e){return new t(function(n,t){for(var o=0,r=e.length;o<r;o++)e[o].then(n,t)})},t._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},t._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t._setImmediateFn=function(e){t._immediateFn=e},t._setUnhandledRejectionFn=function(e){t._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=t:e.Promise||(e.Promise=t)}(this);